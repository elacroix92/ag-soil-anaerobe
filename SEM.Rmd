---
title: "SEM_SHI"
author: "Emily Lacroix"
date: "09 FEB 2023"
output: 
  github_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Set-up 

## Load libraries

```{r message=FALSE}

library(lavaan)
library(psych)
library(readxl)
library(ggfortify)
library(tidyverse)

```

## File names

```{r eval=FALSE}

all_data_excel <-  "AllData_03AUG.xlsx"

```

```{r eval=TRUE, echo=FALSE}

all_data_excel <- "/Users/elacroi3/Documents/Research/SHI/Data/DataCompilation/AllData_03AUG.xlsx"

```

## Import

```{r message=FALSE}

mineral <- 
  all_data_excel %>% 
  read_xlsx(sheet = "mineral_protection") %>% 
  select(-c(ssa_analysis_date, ssa_m2_g)) %>% 
  separate(sample, into = c("site", "till", "amend", "rep")) %>% 
  mutate(
    landscape_position = if_else(site == "GR", amend, NA_character_),
    across(amend, ~if_else(site == "GR", "U", .)),
    across(rep, as.numeric)
  )

sixteenS_abund <-
  all_data_excel %>% 
  read_xlsx(sheet = "dna_ddpcr", na = "NA") %>% 
  distinct(site, till, amend, landscape_position, rep, copies_per_g_sixteenS)

anaerobe_copies_total <- 
  all_data_excel %>% 
  read_xlsx(sheet = "anaerobe_copies", na = "NA") %>% 
  add_row( #adding blank rows for GR-NT-F for now
    site = "GR",
    till = "NT",
    amend = "U",
    landscape_position = "F",
    rep = c(1,3),
    anaerobe_copies_per_g = NA_real_
  )

climate <- 
  all_data_excel %>% 
  read_xlsx(sheet = "climate", na = "NA") %>% 
  rename(rep = field_rep)


root_mass_bd <-
  all_data_excel %>% 
  read_xlsx(sheet = "gravimetric", na = "NA") %>% 
  mutate(
    avg_plant_mass_per_cm3 = plant_mass_2_mm / volume_cm3
  ) %>% 
    group_by(site, till, amend, landscape_position, field_rep) %>% 
    summarise(
      avg_plant_mass_per_cm3 = mean(avg_plant_mass_per_cm3, na.rm = TRUE),
      avg_bd = mean(bd, na.rm = TRUE)
    ) %>% 
  rename(rep = field_rep)

c_n <- 
  all_data_excel %>% 
  read_xlsx(sheet = "c_n", na = "NA") %>%
  rename(
    amend = amend_pos,
    rep = field_rep
  ) %>% 
  mutate(
    landscape_position = if_else(site == "GR", amend, NA_character_),
    across(amend, ~if_else(site == "GR", "U", .)),
  )


anaerobe_matrix <- #already has outlier removed 
  all_data_excel %>% 
  read_xlsx(sheet = "dna_ddpcr", na = "NA") %>% 
  group_by(
    site, till, amend, landscape_position, rep, target_gene
  ) %>% 
  summarise(
    copies_per_g = mean(copies_per_g, na.rm = TRUE),
    prop = mean(prop, na.rm = TRUE)
  ) %>% 
  pivot_wider(
    id_cols = c(site, till, amend, landscape_position, rep),
    names_from = target_gene,
    values_from = c(copies_per_g, prop)
  )

aggregate_est <- 
  all_data_excel %>% 
  read_xlsx(sheet = "agg_est") %>% 
  select(site, till, amend, landscape_position, rep, wsa_perc)


```

## Join it all together   

```{r}

all_data <- 
  mineral %>% 
  left_join(
    sixteenS_abund, 
    by = c("site", "till", "amend", "landscape_position", "rep")
  ) %>% 
  left_join(
    anaerobe_copies_total,
    by = c("site", "till", "amend", "landscape_position", "rep")
  ) %>% 
  left_join(
    climate,
    by = c("site", "till", "amend", "landscape_position", "rep")
  ) %>% 
  left_join(
    root_mass_bd,
    by = c("site", "till", "amend", "landscape_position", "rep")
  ) %>% 
  left_join(
    c_n,
    by = c("site", "till", "amend", "landscape_position", "rep")
  ) %>% 
  left_join(
    anaerobe_matrix,
    by = c("site", "till", "amend", "landscape_position", "rep")
  ) %>% 
  left_join(
    aggregate_est,
    by = c("site", "till", "amend", "landscape_position", "rep")  
  ) %>% 
  filter(!(site == "GR" & landscape_position == "F" & rep %in% c(1,3))) %>% 
  rowid_to_column() %>% 
  arrange(site, till, amend, landscape_position, rep) %>% 
  ungroup() %>% 
  select(-landscape_position) %>% 
  na.omit() %>% 
  mutate(
    across(till, ~factor(., levels = c("UN", "NT", "MT", "CT"), ordered = TRUE)),
    across(amend, ~factor(., levels = c("U", "A"), ordered = TRUE))
  ) %>% 
  filter(
    !(site == "WO" & till == "UN" & rep == 2)
  )

```

# Entire dataset - include site-level variables 

## O2 demand PC

```{r}
o2_demand_pc_data <- 
  all_data %>% 
  select(
    copies_per_g_sixteenS,
    npoc_mg_c_g_soil,
    avg_perc_c,
    mat_c,
    avg_plant_mass_per_cm3
  ) 

o2_demand_pc <- 
  prcomp(~., data = o2_demand_pc_data, scale = TRUE)

o2_demand_pc1 <- o2_demand_pc$x %>% as_tibble() %>% pull(PC1)

autoplot(
  o2_demand_pc, 
  loadings = TRUE,
  loadings.label = TRUE,
  loadings.label.size = 4,
  loadings.label.hjust = 0.5,
  loadings.label.vjust = -1,
  loadings.label.colour = "black",
  alpha = 0.5
) + 
  theme_bw() + 
  theme(
    aspect.ratio = 1
  )

  
```


O2 demand, more negative = more demand expected

## O2 supply PC

```{r}
o2_supp_pc_data <- 
  all_data %>% 
  select(
      avg_bd,
      perc_clay, 
      mean_wfps,
      wsa_perc,
      map_mm,
      precip_in_7
  ) 

o2_supp_pc <- 
  prcomp(~., data = o2_supp_pc_data, scale = TRUE)

autoplot(
  o2_supp_pc,
  loadings = TRUE,
  loadings.label = TRUE,
  loadings.label.size = 4,
  loadings.label.hjust = 0.2,
  loadings.label.colour = "black",
  alpha = 0.5
) + 
  theme_bw() + 
  theme(
    aspect.ratio = 1
  )


o2_supp_pc1 <- o2_supp_pc$x %>% as_tibble() %>% pull(PC1)


```


## Join PCs to data table

```{r}

sem_data <- 
  all_data %>% 
  select(site, till, amend, anaerobe_copies_per_g) %>% 
  add_column(
    o2_demand_pc = o2_demand_pc1,
    o2_supp_pc = o2_supp_pc1
  ) %>% 
  mutate(
    #best transformation for normality
    sqrt_anaerobe_copies_per_g = sqrt(anaerobe_copies_per_g), 
    cultivated = if_else(till == "UN", 0, 1),
    amended = if_else(amend == "A", 1, 0),
    red_no_till = if_else(till %in% c("NT", "MT"), 1, 0),
    scaled_o2_demand_pc = scale(o2_demand_pc),
    scaled_o2_supp_pc = scale(o2_supp_pc),
    scaled_anaerobe = scale(sqrt_anaerobe_copies_per_g)
  ) 

sem_data %>% 
  ggplot(
    aes(x = scaled_anaerobe)
  ) + 
  geom_histogram(bins = 20)
  

shapiro.test(sem_data$scaled_anaerobe)


```

## Apriori SEM model 

### Attempt 1

First: see if there are relationships between everything essentially. We're going to try this on the normally distributed variable sqrt_anaerobe_copies_per_g

Set this up like a series of regressions:

```{r}

apriori_model1 <- 'scaled_o2_demand_pc ~ cultivated + amended + red_no_till + scaled_o2_supp_pc
           scaled_o2_supp_pc ~ cultivated + amended + red_no_till + scaled_o2_demand_pc
           scaled_anaerobe ~ scaled_o2_supp_pc + scaled_o2_demand_pc + cultivated + red_no_till + amended'


apriori_model1_fit <- sem(apriori_model1, data = sem_data)

summary(apriori_model1_fit, standardized = TRUE, ci = TRUE, fit.measures = TRUE)

```

This is seriously overfit (to the point where there are negative degrees of freedom). Remove whichever variable has the smallest coefficient. 

### Attempt 2

```{r}
apriori_model2 <- 'scaled_o2_demand_pc ~ cultivated + amended + scaled_o2_supp_pc
           scaled_o2_supp_pc ~ cultivated + amended + red_no_till + scaled_o2_demand_pc
           scaled_anaerobe ~ scaled_o2_supp_pc + scaled_o2_demand_pc + cultivated + red_no_till + amended'

apriori_model2_fit <- sem(apriori_model2, data = sem_data)

summary(apriori_model2_fit, standardized = TRUE, ci = TRUE, fit.measures = TRUE)

```
This is our apriori model.


## Stepwise removal of non-significant paths

For each model, we remove one non-significant path per step, selecting the path with the highest p-value (least likelihood for significance) with each iteration.

For each of the iterations below, we assess the model for:
i) acceptable model fit, i.e. non-significant chi-squared test, RMSEA < 0.09, and CFI > 0.90
ii) AIC value

At the end of the elimination of non-significant pathways, we compare all models with acceptable fit and then select the one with the lowest AIC value. 

```{r}
model1 <- 'scaled_o2_demand_pc ~ cultivated + amended
           scaled_o2_supp_pc ~ cultivated + amended + red_no_till + scaled_o2_demand_pc
           scaled_anaerobe ~ scaled_o2_supp_pc + scaled_o2_demand_pc + cultivated + red_no_till + amended'

fit1 <- sem(model1, data = sem_data)

summary(fit1, standardized = TRUE, ci = TRUE, fit.measures = TRUE)
```


```{r}

model2 <- 'scaled_o2_demand_pc ~ cultivated + amended
           scaled_o2_supp_pc ~ cultivated + amended + red_no_till + scaled_o2_demand_pc
           scaled_anaerobe ~ scaled_o2_supp_pc + scaled_o2_demand_pc + cultivated + red_no_till'

fit2 <- sem(model2, data = sem_data)

summary(fit2, standardized = TRUE, ci = TRUE, fit.measures = TRUE)
```

```{r}

model3 <- 'scaled_o2_demand_pc ~ cultivated + amended
           scaled_o2_supp_pc ~ cultivated + amended + red_no_till + scaled_o2_demand_pc
           scaled_anaerobe ~ scaled_o2_supp_pc + cultivated + red_no_till'

fit3 <- sem(model3, data = sem_data)

summary(fit3, standardized = TRUE, ci = TRUE, fit.measures = TRUE)
```


```{r}

model4 <- 'scaled_o2_demand_pc ~ cultivated + amended
           scaled_o2_supp_pc ~ cultivated + amended + scaled_o2_demand_pc + red_no_till
           scaled_anaerobe ~ scaled_o2_supp_pc + cultivated'

fit4 <- sem(model4, data = sem_data)

summary(fit4, standardized = TRUE, ci = TRUE, fit.measures = TRUE)

```

### Best fit

```{r}

model5 <- 'scaled_o2_demand_pc ~ cultivated + amended
           scaled_o2_supp_pc ~ cultivated + amended + scaled_o2_demand_pc
           scaled_anaerobe ~ scaled_o2_supp_pc + cultivated'

fit5 <- sem(model5, data = sem_data)

summary(fit5, standardized = TRUE, ci = TRUE, fit.measures = TRUE)


```

### Final fit (non-viable fit)
```{r}

model6 <- 'scaled_o2_demand_pc ~ cultivated
           scaled_o2_supp_pc ~ cultivated + amended + scaled_o2_demand_pc
           scaled_anaerobe ~ scaled_o2_supp_pc + cultivated'


fit6 <- sem(model6, data = sem_data)

summary(fit6, standardized = TRUE, ci = TRUE, fit.measures = TRUE)
```


# CREC only

## O2 demand PC

```{r}
o2_demand_pc_data_crec <- 
  all_data %>% 
  filter(site == "CREC") %>% 
  select(
    copies_per_g_sixteenS,
    npoc_mg_c_g_soil,
    avg_perc_c,
    avg_plant_mass_per_cm3
  ) 

o2_demand_pc_crec <- 
  prcomp(~., data = o2_demand_pc_data_crec, scale = TRUE)

o2_demand_pc1_crec <- o2_demand_pc_crec$x %>% as_tibble() %>% pull(PC1)

autoplot(
  o2_demand_pc_crec, 
  loadings = TRUE,
  loadings.label = TRUE,
  loadings.label.size = 4,
  loadings.label.hjust = 0.5,
  loadings.label.vjust = -1,
  loadings.label.colour = "black",
  alpha = 0.5
) + 
  theme_bw() + 
  theme(
    aspect.ratio = 1
  )

```

## O2 supply PC

```{r}
o2_supp_pc_data_crec <- 
  all_data %>% 
  filter(site == "CREC") %>% 
  select(
      avg_bd,
      perc_clay, 
      mean_wfps,
      wsa_perc
  ) 

o2_supp_pc_crec <- 
  prcomp(~., data = o2_supp_pc_data_crec, scale = TRUE)

autoplot(
  o2_supp_pc_crec,
 loadings = TRUE,
  loadings.label = TRUE,
  loadings.label.size = 4,
  loadings.label.hjust = 0.2,
  loadings.label.colour = "black",
  alpha = 0.5
) + 
  theme_bw() + 
  theme(
    aspect.ratio = 1
  )

o2_supp_pc1_crec <- o2_supp_pc_crec$x %>% as_tibble() %>% pull(PC1)

```

## Join PCs to data table

```{r}

sem_data_crec <- 
  all_data %>% 
  filter(site == "CREC") %>% 
  select(site, till, amend, anaerobe_copies_per_g) %>% 
  add_column(
    o2_demand_pc = o2_demand_pc1_crec,
    o2_supp_pc = o2_supp_pc1_crec
  ) %>% 
  mutate(
    #best transformation 
    sqrt_anaerobe_copies_per_g = sqrt(anaerobe_copies_per_g), 
    cultivated = if_else(till == "UN", 0, 1),
    amended = if_else(amend == "A", 1, 0),
    red_no_till = if_else(till %in% c("NT", "MT"), 1, 0),
    scaled_o2_demand_crec = scale(o2_demand_pc1_crec),
    scaled_o2_supp_crec = scale(o2_supp_pc1_crec),
    scaled_anaerobe = scale(sqrt_anaerobe_copies_per_g)
  ) 

```


## Apriori model

### Attempt 1

Same as apriori model for entire dataset

```{r}

apriori_crec_model1 <- 
          'scaled_o2_demand_crec ~ cultivated + amended + scaled_o2_supp_crec
           scaled_o2_supp_crec ~ cultivated + amended + red_no_till + scaled_o2_demand_crec
           scaled_anaerobe ~ scaled_o2_supp_crec + scaled_o2_demand_crec + cultivated + red_no_till + amended'


apriori_crec_fit1 <- sem(apriori_crec_model1, data = sem_data_crec)

summary(apriori_crec_fit1, standardized = TRUE, ci = TRUE, fit.measures = TRUE)
```

## Stepwise removal of non-significant paths

```{r}

model1_crec <- 
          'scaled_o2_demand_crec ~ cultivated + amended + scaled_o2_supp_crec
           scaled_o2_supp_crec ~ cultivated + amended + red_no_till + scaled_o2_demand_crec
           scaled_anaerobe ~ scaled_o2_demand_crec + cultivated + red_no_till + amended'


fit1_crec <- sem(model1_crec, data = sem_data_crec)

summary(fit1_crec, standardized=TRUE, ci=TRUE, fit.measures=TRUE)

```


```{r}

model2_crec <- 
          'scaled_o2_demand_crec ~ cultivated + amended + scaled_o2_supp_crec
           scaled_o2_supp_crec ~ cultivated + red_no_till + scaled_o2_demand_crec
           scaled_anaerobe ~ scaled_o2_demand_crec + cultivated + red_no_till + amended'

fit2_crec <- sem(model2_crec, data = sem_data_crec)

summary(fit2_crec, standardized = TRUE, ci = TRUE, fit.measures = TRUE)

```

### Best fit

Lowest AIC of viable model fits
```{r}


model3_crec <- 
          'scaled_o2_demand_crec ~ cultivated + amended + scaled_o2_supp_crec
           scaled_o2_supp_crec ~ cultivated + red_no_till + scaled_o2_demand_crec
           scaled_anaerobe ~ cultivated + red_no_till + amended'


fit3_crec <- sem(model3_crec, data = sem_data_crec)

summary(fit3_crec, standardized=TRUE, ci=TRUE, fit.measures=TRUE)

```

```{r}

model4_crec <- 
          'scaled_o2_demand_crec ~ cultivated + amended
           scaled_o2_supp_crec ~ cultivated + red_no_till + scaled_o2_demand_crec
           scaled_anaerobe ~ cultivated + red_no_till + amended'


fit4_crec <- sem(model4_crec, data = sem_data_crec)

summary(fit4_crec, standardized = TRUE, ci = TRUE, fit.measures = TRUE)

```



```{r}

model5_crec <- 
          'scaled_o2_demand_crec ~ cultivated + amended
           scaled_o2_supp_crec ~ cultivated + red_no_till
           scaled_anaerobe ~ cultivated + red_no_till + amended'

fit5_crec <- sem(model5_crec, data = sem_data_crec)

summary(fit5_crec, standardized = TRUE, ci = TRUE, fit.measures = TRUE)

```


```{r}

model6_crec <- 
          'scaled_o2_demand_crec ~ cultivated + amended
           scaled_o2_supp_crec ~ cultivated
           scaled_anaerobe ~ cultivated + red_no_till + amended'


fit6_crec <- sem(model6_crec, data = sem_data_crec)

summary(fit6_crec, standardized = TRUE, ci = TRUE, fit.measures = TRUE)

```

```{r}

model7_crec <- 
          'scaled_o2_demand_crec ~ cultivated + amended
           scaled_o2_supp_crec ~ cultivated
           scaled_anaerobe ~ cultivated + amended'

fit7_crec <- sem(model7_crec, data = sem_data_crec)

summary(fit7_crec, standardized = TRUE, ci = TRUE, fit.measures = TRUE)

```

### Force fit
```{r}

model8_crec <- 
          'scaled_o2_demand_crec ~ cultivated + amended
           scaled_o2_supp_crec ~ cultivated
           scaled_anaerobe ~ cultivated + amended + scaled_o2_demand_crec + scaled_o2_supp_crec'

fit8_crec <- sem(model8_crec, data = sem_data_crec)

summary(fit8_crec, standardized = TRUE, ci = TRUE, fit.measures = TRUE)
```

# Entire dataset - no site level variables

## O2 demand PC

```{r}
o2_demand_pc_data <- 
  all_data %>% 
  select(
    copies_per_g_sixteenS,
    npoc_mg_c_g_soil,
    avg_perc_c,
    avg_plant_mass_per_cm3
  ) 

o2_demand_pc <- 
  prcomp(~., data = o2_demand_pc_data, scale = TRUE)

o2_demand_pc1 <- o2_demand_pc$x %>% as_tibble() %>% pull(PC1)

autoplot(
  o2_demand_pc, 
  loadings = TRUE,
  loadings.label = TRUE,
  loadings.label.size = 4,
  loadings.label.hjust = 0.5,
  loadings.label.vjust = -1,
  loadings.label.colour = "black",
  alpha = 0.5
) + 
  theme_bw() + 
  theme(
    aspect.ratio = 1
  )

  
```
O2 demand, more negative = more demand expected

## O2 supply PC

```{r}
o2_supp_pc_data <- 
  all_data %>% 
  select(
      avg_bd,
      perc_clay, 
      wsa_perc
  ) 

o2_supp_pc <- 
  prcomp(~., data = o2_supp_pc_data, scale = TRUE)

autoplot(
  o2_supp_pc,
 loadings = TRUE,
  loadings.label = TRUE,
  loadings.label.size = 4,
  loadings.label.hjust = 0.2,
  loadings.label.colour = "black",
  alpha = 0.5
) + 
  theme_bw() + 
  theme(
    aspect.ratio = 1
  )
  

o2_supp_pc1 <- o2_supp_pc$x %>% as_tibble() %>% pull(PC1)

```

## Join PCs to data table

```{r}
sem_data_2 <- 
  all_data %>% 
  select(site, till, amend, anaerobe_copies_per_g) %>% 
  add_column(
    o2_demand_pc = o2_demand_pc1,
    o2_supp_pc = o2_supp_pc1
  ) %>% 
  mutate(
    log_anaerobe_copies = log(anaerobe_copies_per_g),
    log10_anaerobe_copies = log10(anaerobe_copies_per_g),
    sqrt_anaerobe_copies_per_g = sqrt(anaerobe_copies_per_g), # this is the best transformation 
    cultivated = if_else(till == "UN", 0, 1),
    amended = if_else(amend == "A", 1, 0),
    red_no_till = if_else(till %in% c("NT", "MT"), 1, 0),
    scaled_o2_demand_pc = scale(o2_demand_pc),
    scaled_o2_supp_pc = scale(o2_supp_pc),
    scaled_anaerobe = scale(sqrt_anaerobe_copies_per_g)
  ) 
```

## Apriori model

```{r}

apriori_model1 <- 'scaled_o2_demand_pc ~ cultivated + amended + red_no_till + scaled_o2_supp_pc
           scaled_o2_supp_pc ~ cultivated + amended + red_no_till + scaled_o2_demand_pc
           scaled_anaerobe ~ scaled_o2_supp_pc + scaled_o2_demand_pc + cultivated + red_no_till + amended'


apriori_model1_fit <- sem(apriori_model1, data = sem_data_2)

summary(apriori_model1_fit, standardized = TRUE, ci = TRUE, fit.measures = TRUE)

```

## Stepwise removal of non-significant paths

```{r}
apriori_model2 <- 'scaled_o2_demand_pc ~ cultivated + amended + scaled_o2_supp_pc
           scaled_o2_supp_pc ~ cultivated + amended + red_no_till + scaled_o2_demand_pc
           scaled_anaerobe ~ scaled_o2_supp_pc + scaled_o2_demand_pc + cultivated + red_no_till + amended'


apriori_model2_fit <- sem(apriori_model2, data = sem_data_2)

summary(apriori_model2_fit, standardized = TRUE, ci = TRUE, fit.measures = TRUE)

```


```{r}
model1 <- 'scaled_o2_demand_pc ~ cultivated + amended
           scaled_o2_supp_pc ~ cultivated + amended + red_no_till + scaled_o2_demand_pc
           scaled_anaerobe ~ scaled_o2_supp_pc + scaled_o2_demand_pc + cultivated + red_no_till + amended'


model1_fit <- sem(model1, data = sem_data_2)

summary(model1_fit, standardized = TRUE, ci = TRUE, fit.measures = TRUE)
```

```{r}
model2 <- 'scaled_o2_demand_pc ~ cultivated + amended
           scaled_o2_supp_pc ~ cultivated + amended + red_no_till + scaled_o2_demand_pc
           scaled_anaerobe ~ scaled_o2_supp_pc + scaled_o2_demand_pc + cultivated + amended'


model2_fit <- sem(model2, data = sem_data_2)

summary(model2_fit, standardized = TRUE, ci = TRUE, fit.measures = TRUE)
```


```{r}
model3 <- 'scaled_o2_demand_pc ~ cultivated + amended
           scaled_o2_supp_pc ~ cultivated + amended + red_no_till + scaled_o2_demand_pc
           scaled_anaerobe ~ scaled_o2_supp_pc + scaled_o2_demand_pc + cultivated'


model3_fit <- sem(model3, data = sem_data_2)

summary(model3_fit, standardized = TRUE, ci = TRUE, fit.measures = TRUE)
```

### Best fit
```{r}
model4 <- 'scaled_o2_demand_pc ~ cultivated + amended
           scaled_o2_supp_pc ~ cultivated + amended + scaled_o2_demand_pc
           scaled_anaerobe ~ scaled_o2_supp_pc + scaled_o2_demand_pc + cultivated'


model4_fit <- sem(model4, data = sem_data_2)

summary(model4_fit, standardized = TRUE, ci = TRUE, fit.measures = TRUE)
```

### Final fit (non-viable fit)
```{r}

model5 <- 'scaled_o2_demand_pc ~ cultivated + amended
           scaled_o2_supp_pc ~ cultivated + amended + scaled_o2_demand_pc
           scaled_anaerobe ~ scaled_o2_supp_pc + cultivated'


model5_fit <- sem(model5, data = sem_data_2)

summary(model5_fit, standardized = TRUE, ci = TRUE, fit.measures = TRUE)
```


